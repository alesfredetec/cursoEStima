<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Clase 2 - Anexos PERT/CPM: Ejemplos Gr√°ficos y C√°lculos</title>
    <script src="config.js" onerror="console.warn('config.js not found - OpenAI TTS disabled'); window.CONFIG = {OPENAI_API_KEY: null};"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: #0a0a0a;
            color: #ffffff;
            overflow: hidden;
            height: 100vh;
        }

        .background-gradient {
            position: fixed;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: -1;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            opacity: 0.1;
        }

        /* Main Layout: 70/30 Split */
        .main-container {
            display: flex;
            width: 100%;
            height: 100vh;
        }

        .slide-area {
            width: 70%;
            height: 100vh;
            position: relative;
        }

        .sidebar {
            width: 30%;
            height: 100vh;
            background: rgba(20, 20, 20, 0.95);
            backdrop-filter: blur(20px);
            border-left: 1px solid rgba(102, 126, 234, 0.3);
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
        }

        .sidebar.hidden {
            transform: translateX(100%);
        }

        .sidebar-header {
            padding: 20px;
            border-bottom: 1px solid rgba(102, 126, 234, 0.2);
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.2), rgba(118, 75, 162, 0.2));
        }

        .sidebar-title {
            font-size: 1.1rem;
            color: #667eea;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .sidebar-duration {
            font-size: 0.9rem;
            color: #a0a0a0;
        }

        .sidebar-body {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
        }

        .sidebar-body::-webkit-scrollbar {
            width: 6px;
        }

        .sidebar-body::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
        }

        .sidebar-body::-webkit-scrollbar-thumb {
            background: rgba(102, 126, 234, 0.5);
            border-radius: 3px;
        }

        .speech-content {
            font-size: 0.95rem;
            line-height: 1.7;
            color: #e0e0e0;
        }

        .speech-content p {
            margin-bottom: 15px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 40px 60px 80px 60px;
            height: 100vh;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
        }

        .container::-webkit-scrollbar {
            width: 8px;
        }

        .container::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
        }

        .container::-webkit-scrollbar-thumb {
            background: rgba(102, 126, 234, 0.5);
            border-radius: 4px;
        }

        .slide {
            min-height: calc(100vh - 180px);
            display: none;
            flex-direction: column;
            justify-content: flex-start;
            padding: 20px 0;
        }

        .slide.active {
            display: flex;
        }

        .slide-content {
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(10px);
            padding: 40px;
            border-radius: 20px;
            border: 1px solid rgba(102, 126, 234, 0.2);
        }

        h1 {
            font-size: 3rem;
            margin-bottom: 30px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-align: center;
        }

        h2 {
            font-size: 2.2rem;
            margin-bottom: 25px;
            color: #667eea;
            border-bottom: 2px solid rgba(102, 126, 234, 0.3);
            padding-bottom: 15px;
        }

        h3 {
            font-size: 1.6rem;
            margin: 25px 0 15px 0;
            color: #a78bfa;
        }

        h4 {
            font-size: 1.3rem;
            margin: 20px 0 10px 0;
            color: #c4b5fd;
        }

        p, li {
            font-size: 1.1rem;
            line-height: 1.8;
            margin-bottom: 15px;
        }

        .formula {
            background: rgba(102, 126, 234, 0.1);
            border-left: 4px solid #667eea;
            padding: 20px;
            margin: 20px 0;
            font-family: 'Courier New', monospace;
            font-size: 1.3rem;
            border-radius: 8px;
        }

        .highlight {
            color: #fbbf24;
            font-weight: 600;
        }

        .example-box {
            background: rgba(16, 185, 129, 0.1);
            border: 2px solid rgba(16, 185, 129, 0.3);
            padding: 25px;
            margin: 25px 0;
            border-radius: 12px;
        }

        .warning-box {
            background: rgba(239, 68, 68, 0.1);
            border: 2px solid rgba(239, 68, 68, 0.3);
            padding: 25px;
            margin: 25px 0;
            border-radius: 12px;
        }

        .info-box {
            background: rgba(59, 130, 246, 0.1);
            border: 2px solid rgba(59, 130, 246, 0.3);
            padding: 25px;
            margin: 25px 0;
            border-radius: 12px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 25px 0;
            font-size: 1rem;
        }

        th, td {
            padding: 15px;
            text-align: left;
            border: 1px solid rgba(102, 126, 234, 0.3);
        }

        th {
            background: rgba(102, 126, 234, 0.2);
            color: #667eea;
            font-weight: 600;
        }

        tr:nth-child(even) {
            background: rgba(255, 255, 255, 0.02);
        }

        .chart-container {
            margin: 30px 0;
            padding: 20px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            border: 1px solid rgba(102, 126, 234, 0.2);
        }

        canvas {
            max-width: 100%;
            height: auto;
        }

        .calculation-step {
            background: rgba(102, 126, 234, 0.05);
            padding: 15px;
            margin: 10px 0;
            border-left: 3px solid #667eea;
            border-radius: 6px;
        }

        .controls {
            position: fixed;
            bottom: 15px;
            right: 20px;
            display: flex;
            gap: 8px;
            z-index: 100;
            background: rgba(20, 20, 20, 0.98);
            padding: 8px 15px;
            border-radius: 30px;
            border: 1px solid rgba(102, 126, 234, 0.4);
            backdrop-filter: blur(15px);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
            align-items: center;
        }

        .btn {
            padding: 8px 16px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s ease;
            font-weight: 600;
            white-space: nowrap;
            min-width: 80px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.5);
        }

        .btn:disabled {
            opacity: 0.3;
            cursor: not-allowed;
            transform: none;
        }

        .btn:disabled:hover {
            transform: none;
            box-shadow: none;
        }

        .slide-counter {
            padding: 8px 16px;
            background: rgba(102, 126, 234, 0.15);
            border-radius: 20px;
            font-weight: 600;
            color: #667eea;
            font-size: 0.9rem;
            min-width: 60px;
            text-align: center;
        }

        .tts-controls {
            position: fixed;
            top: 20px;
            right: 20px;
            display: flex;
            gap: 10px;
            z-index: 100;
            background: rgba(20, 20, 20, 0.95);
            padding: 15px;
            border-radius: 15px;
            border: 1px solid rgba(102, 126, 234, 0.3);
            backdrop-filter: blur(10px);
        }

        .tts-btn {
            padding: 10px 20px;
            background: rgba(102, 126, 234, 0.2);
            color: #667eea;
            border: 1px solid #667eea;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }

        .tts-btn:hover {
            background: rgba(102, 126, 234, 0.4);
        }

        .tts-btn.active {
            background: #667eea;
            color: white;
        }

        select {
            padding: 10px 15px;
            background: rgba(20, 20, 20, 0.9);
            color: #ffffff;
            border: 1px solid rgba(102, 126, 234, 0.3);
            border-radius: 10px;
            font-size: 0.9rem;
            cursor: pointer;
        }

        .monte-carlo-viz {
            display: grid;
            grid-template-columns: repeat(10, 1fr);
            gap: 5px;
            margin: 20px 0;
        }

        .monte-carlo-bar {
            height: 100px;
            background: linear-gradient(to top, #667eea, #764ba2);
            border-radius: 4px;
            position: relative;
            transition: all 0.3s ease;
        }

        .monte-carlo-bar:hover {
            transform: scaleY(1.05);
            box-shadow: 0 0 20px rgba(102, 126, 234, 0.6);
        }

        .stat-card {
            background: rgba(102, 126, 234, 0.1);
            border: 1px solid rgba(102, 126, 234, 0.3);
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            margin: 10px;
        }

        .stat-value {
            font-size: 2.5rem;
            color: #667eea;
            font-weight: 700;
            margin: 10px 0;
        }

        .stat-label {
            font-size: 1rem;
            color: #a0a0a0;
        }

        .grid-2col {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }

        .grid-3col {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <div class="background-gradient"></div>

    <div class="main-container">
        <!-- Main Slide Area (70%) -->
        <div class="slide-area">
            <div class="container">
                <!-- Slide 1: Portada -->
                <div class="slide active">
                    <div class="slide-content">
                        <h1>üìä Anexos PERT/CPM</h1>
                        <h2 style="text-align: center; border: none; color: #a78bfa;">Ejemplos Gr√°ficos y C√°lculos Detallados</h2>

                        <div style="text-align: center; margin: 40px 0;">
                            <p style="font-size: 1.4rem; color: #c4b5fd;">Complemento a Clase 2: Slides 5, 6 y 7</p>
                            <p style="font-size: 1.2rem; color: #a0a0a0; margin-top: 20px;">Material de Apoyo Pedag√≥gico</p>
                        </div>

                        <div class="info-box">
                            <h3 style="margin-top: 0;">üéØ Contenido de Este Anexo</h3>
                            <ul style="list-style: none; padding-left: 0;">
                                <li style="padding: 10px 0; border-bottom: 1px solid rgba(102, 126, 234, 0.2);">
                                    <span class="highlight">Slide 2-3:</span> Ejemplo con 1 tarea (c√°lculos PERT b√°sicos paso a paso)
                                </li>
                                <li style="padding: 10px 0; border-bottom: 1px solid rgba(102, 126, 234, 0.2);">
                                    <span class="highlight">Slide 4-5:</span> Ejemplo con 100 tareas (proyecto complejo real)
                                </li>
                                <li style="padding: 10px 0; border-bottom: 1px solid rgba(102, 126, 234, 0.2);">
                                    <span class="highlight">Slide 6:</span> Gr√°ficos de Desviaci√≥n Est√°ndar (œÉ)
                                </li>
                                <li style="padding: 10px 0; border-bottom: 1px solid rgba(102, 126, 234, 0.2);">
                                    <span class="highlight">Slide 7:</span> Gr√°ficos de Varianza (œÉ¬≤)
                                </li>
                                <li style="padding: 10px 0;">
                                    <span class="highlight">Slide 8-9:</span> Simulaci√≥n de Monte Carlo (10,000 iteraciones)
                                </li>
                            </ul>
                        </div>

                        <div class="warning-box" style="margin-top: 30px;">
                            <h4 style="margin-top: 0;">‚ö†Ô∏è Prerequisitos</h4>
                            <p style="margin-bottom: 0;">Este material asume que ya viste los <strong>Slides 3-7 de Clase 2</strong>: PERT, CPM, y Combinando PERT/CPM.</p>
                        </div>
                    </div>
                </div>

                <!-- Slide 2: Ejemplo 1 Tarea - Parte 1 -->
                <div class="slide">
                    <div class="slide-content">
                        <h2>üìê Ejemplo 1: Una Tarea Simple</h2>
                        <h3>Migraci√≥n de Base de Datos</h3>

                        <div class="example-box">
                            <h4>Contexto</h4>
                            <p>Necesitamos migrar una base de datos de PostgreSQL 12 a PostgreSQL 15 en producci√≥n.</p>

                            <h4 style="margin-top: 25px;">Estimaciones del Equipo</h4>
                            <table>
                                <tr>
                                    <th>Estimaci√≥n</th>
                                    <th>Valor</th>
                                    <th>Justificaci√≥n</th>
                                </tr>
                                <tr>
                                    <td><strong>Optimista (O)</strong></td>
                                    <td class="highlight">5 d√≠as</td>
                                    <td>Todo sale perfecto, scripts funcionan, sin rollbacks</td>
                                </tr>
                                <tr>
                                    <td><strong>M√°s Probable (M)</strong></td>
                                    <td class="highlight">10 d√≠as</td>
                                    <td>Algunos ajustes de queries, 1-2 rollbacks menores</td>
                                </tr>
                                <tr>
                                    <td><strong>Pesimista (P)</strong></td>
                                    <td class="highlight">25 d√≠as</td>
                                    <td>Incompatibilidades mayores, problemas de rendimiento, m√∫ltiples rollbacks</td>
                                </tr>
                            </table>
                        </div>

                        <div class="formula">
                            <strong>F√≥rmula PERT:</strong><br>
                            Œº (Duraci√≥n Esperada) = (O + 4M + P) / 6
                        </div>

                        <div class="calculation-step">
                            <h4>Paso 1: Sustituir valores</h4>
                            <p style="font-family: 'Courier New', monospace; font-size: 1.2rem;">
                                Œº = (5 + 4√ó10 + 25) / 6
                            </p>
                        </div>

                        <div class="calculation-step">
                            <h4>Paso 2: Multiplicar 4M</h4>
                            <p style="font-family: 'Courier New', monospace; font-size: 1.2rem;">
                                Œº = (5 + 40 + 25) / 6
                            </p>
                        </div>

                        <div class="calculation-step">
                            <h4>Paso 3: Sumar numerador</h4>
                            <p style="font-family: 'Courier New', monospace; font-size: 1.2rem;">
                                Œº = 70 / 6
                            </p>
                        </div>

                        <div class="calculation-step">
                            <h4>Paso 4: Dividir</h4>
                            <p style="font-family: 'Courier New', monospace; font-size: 1.2rem;">
                                Œº = <span class="highlight">11.67 d√≠as ‚âà 12 d√≠as</span>
                            </p>
                        </div>
                    </div>
                </div>

                <!-- Slide 3: Ejemplo 1 Tarea - Parte 2 (Desviaci√≥n Est√°ndar) -->
                <div class="slide">
                    <div class="slide-content">
                        <h2>üìê Ejemplo 1: Desviaci√≥n Est√°ndar (œÉ)</h2>

                        <div class="formula">
                            <strong>F√≥rmula de Desviaci√≥n Est√°ndar:</strong><br>
                            œÉ = (P - O) / 6
                        </div>

                        <div class="calculation-step">
                            <h4>Paso 1: Sustituir valores</h4>
                            <p style="font-family: 'Courier New', monospace; font-size: 1.2rem;">
                                œÉ = (25 - 5) / 6
                            </p>
                        </div>

                        <div class="calculation-step">
                            <h4>Paso 2: Restar</h4>
                            <p style="font-family: 'Courier New', monospace; font-size: 1.2rem;">
                                œÉ = 20 / 6
                            </p>
                        </div>

                        <div class="calculation-step">
                            <h4>Paso 3: Dividir</h4>
                            <p style="font-family: 'Courier New', monospace; font-size: 1.2rem;">
                                œÉ = <span class="highlight">3.33 d√≠as</span>
                            </p>
                        </div>

                        <div class="info-box" style="margin-top: 30px;">
                            <h3 style="margin-top: 0;">üéØ Resultado Final</h3>
                            <div class="grid-2col">
                                <div class="stat-card">
                                    <div class="stat-label">Duraci√≥n Esperada</div>
                                    <div class="stat-value">12 d√≠as</div>
                                    <div class="stat-label">(Œº)</div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-label">Desviaci√≥n Est√°ndar</div>
                                    <div class="stat-value">¬±3.33 d√≠as</div>
                                    <div class="stat-label">(œÉ)</div>
                                </div>
                            </div>
                        </div>

                        <div class="example-box">
                            <h4>Interpretaci√≥n Pr√°ctica</h4>
                            <p><strong>Rango de confianza 68%</strong> (¬±1œÉ):</p>
                            <p style="font-size: 1.3rem; text-align: center; margin: 15px 0;">
                                12 - 3.33 = <span class="highlight">8.67 d√≠as</span> a 12 + 3.33 = <span class="highlight">15.33 d√≠as</span>
                            </p>

                            <p><strong>Rango de confianza 95%</strong> (¬±2œÉ):</p>
                            <p style="font-size: 1.3rem; text-align: center; margin: 15px 0;">
                                12 - 6.66 = <span class="highlight">5.34 d√≠as</span> a 12 + 6.66 = <span class="highlight">18.66 d√≠as</span>
                            </p>

                            <p><strong>Rango de confianza 99.7%</strong> (¬±3œÉ):</p>
                            <p style="font-size: 1.3rem; text-align: center; margin: 15px 0;">
                                12 - 9.99 = <span class="highlight">2 d√≠as</span> a 12 + 9.99 = <span class="highlight">22 d√≠as</span>
                            </p>
                        </div>

                        <div class="warning-box">
                            <h4>‚ö†Ô∏è Insight Clave</h4>
                            <p>Aunque el valor esperado es <strong>12 d√≠as</strong>, hay un <strong>32% de probabilidad</strong> de que tome m√°s de 15 d√≠as.</p>
                            <p style="margin-bottom: 0; margin-top: 15px;">Por eso PERT siempre reporta: <strong>Œº ¬± œÉ</strong> ‚Üí <strong>12 ¬± 3.33 d√≠as</strong></p>
                        </div>
                    </div>
                </div>

                <!-- Slide 4: Ejemplo 100 Tareas - Parte 1 -->
                <div class="slide">
                    <div class="slide-content">
                        <h2>üèóÔ∏è Ejemplo 2: Proyecto con 100 Tareas</h2>
                        <h3>Sistema E-Commerce Completo</h3>

                        <div class="info-box">
                            <h4>Contexto del Proyecto</h4>
                            <p>Desarrollo de plataforma e-commerce desde cero:</p>
                            <ul>
                                <li>Frontend (React): 25 tareas</li>
                                <li>Backend (Node.js): 30 tareas</li>
                                <li>Base de datos y APIs: 20 tareas</li>
                                <li>Testing y QA: 15 tareas</li>
                                <li>DevOps y Deploy: 10 tareas</li>
                            </ul>
                        </div>

                        <div class="example-box">
                            <h4>Ruta Cr√≠tica Identificada (CPM)</h4>
                            <p>El an√°lisis CPM identific√≥ 40 tareas en la ruta cr√≠tica:</p>
                            <ul>
                                <li>Setup inicial ‚Üí Arquitectura ‚Üí Auth ‚Üí Cat√°logo ‚Üí Carrito ‚Üí Checkout ‚Üí Payment ‚Üí Testing E2E ‚Üí Deploy</li>
                            </ul>
                        </div>

                        <h3 style="margin-top: 30px;">C√°lculos PERT Agregados</h3>

                        <table>
                            <tr>
                                <th>Tarea</th>
                                <th>O (d√≠as)</th>
                                <th>M (d√≠as)</th>
                                <th>P (d√≠as)</th>
                                <th>Œº (d√≠as)</th>
                                <th>œÉ (d√≠as)</th>
                            </tr>
                            <tr>
                                <td>1. Setup & Arquitectura</td>
                                <td>3</td>
                                <td>5</td>
                                <td>10</td>
                                <td>5.5</td>
                                <td>1.17</td>
                            </tr>
                            <tr>
                                <td>2. Sistema de Auth</td>
                                <td>5</td>
                                <td>10</td>
                                <td>20</td>
                                <td>10.83</td>
                                <td>2.5</td>
                            </tr>
                            <tr>
                                <td>3. Cat√°logo de Productos</td>
                                <td>8</td>
                                <td>15</td>
                                <td>30</td>
                                <td>16.33</td>
                                <td>3.67</td>
                            </tr>
                            <tr>
                                <td>4. Carrito de Compras</td>
                                <td>6</td>
                                <td>12</td>
                                <td>25</td>
                                <td>13.17</td>
                                <td>3.17</td>
                            </tr>
                            <tr>
                                <td>5. Proceso de Checkout</td>
                                <td>10</td>
                                <td>20</td>
                                <td>40</td>
                                <td>21.67</td>
                                <td>5.0</td>
                            </tr>
                            <tr>
                                <td>... (35 tareas m√°s)</td>
                                <td colspan="5" style="text-align: center; color: #a0a0a0;">Ver tabla completa en documentaci√≥n</td>
                            </tr>
                            <tr style="background: rgba(102, 126, 234, 0.2); font-weight: bold;">
                                <td><strong>TOTAL (Ruta Cr√≠tica)</strong></td>
                                <td>-</td>
                                <td>-</td>
                                <td>-</td>
                                <td class="highlight">180 d√≠as</td>
                                <td class="highlight">¬±15 d√≠as</td>
                            </tr>
                        </table>
                    </div>
                </div>

                <!-- Slide 5: Ejemplo 100 Tareas - Parte 2 (Resultados) -->
                <div class="slide">
                    <div class="slide-content">
                        <h2>üèóÔ∏è Ejemplo 2: Resultados del Proyecto</h2>

                        <div class="grid-3col">
                            <div class="stat-card">
                                <div class="stat-label">Total de Tareas</div>
                                <div class="stat-value">100</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-label">Ruta Cr√≠tica</div>
                                <div class="stat-value">40</div>
                                <div class="stat-label">tareas</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-label">Holgura Disponible</div>
                                <div class="stat-value">60</div>
                                <div class="stat-label">tareas</div>
                            </div>
                        </div>

                        <div class="info-box">
                            <h3 style="margin-top: 0;">üìä Resultado PERT Final</h3>
                            <div class="grid-2col" style="margin-top: 20px;">
                                <div class="stat-card">
                                    <div class="stat-label">Duraci√≥n Esperada</div>
                                    <div class="stat-value">180 d√≠as</div>
                                    <div class="stat-label">(Œº total = Œ£Œº·µ¢ en ruta cr√≠tica)</div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-label">Desviaci√≥n Est√°ndar</div>
                                    <div class="stat-value">¬±15 d√≠as</div>
                                    <div class="stat-label">(œÉ total = ‚àö(Œ£œÉ·µ¢¬≤))</div>
                                </div>
                            </div>
                        </div>

                        <div class="calculation-step">
                            <h4>C√°lculo de œÉ Total (Varianza Agregada)</h4>
                            <p style="font-family: 'Courier New', monospace;">
                                œÉ¬≤_total = œÉ‚ÇÅ¬≤ + œÉ‚ÇÇ¬≤ + œÉ‚ÇÉ¬≤ + ... + œÉ‚ÇÑ‚ÇÄ¬≤<br>
                                œÉ¬≤_total = 1.17¬≤ + 2.5¬≤ + 3.67¬≤ + ... (40 t√©rminos)<br>
                                œÉ¬≤_total = 225 d√≠as¬≤<br>
                                <span class="highlight">œÉ_total = ‚àö225 = 15 d√≠as</span>
                            </p>
                        </div>

                        <div class="example-box">
                            <h4>Rangos de Confianza</h4>
                            <table>
                                <tr>
                                    <th>Nivel de Confianza</th>
                                    <th>Rango (d√≠as)</th>
                                    <th>Interpretaci√≥n</th>
                                </tr>
                                <tr>
                                    <td><strong>68%</strong> (¬±1œÉ)</td>
                                    <td class="highlight">165 - 195 d√≠as</td>
                                    <td>Rango probable normal</td>
                                </tr>
                                <tr>
                                    <td><strong>95%</strong> (¬±2œÉ)</td>
                                    <td class="highlight">150 - 210 d√≠as</td>
                                    <td>Rango para planning conservador</td>
                                </tr>
                                <tr>
                                    <td><strong>99.7%</strong> (¬±3œÉ)</td>
                                    <td class="highlight">135 - 225 d√≠as</td>
                                    <td>Rango extremos incluidos</td>
                                </tr>
                            </table>
                        </div>

                        <div class="warning-box">
                            <h4>üéØ Decisi√≥n de Management</h4>
                            <p><strong>Opci√≥n 1 (Agresivo):</strong> Comprometer 180 d√≠as ‚Üí 50% probabilidad de √©xito</p>
                            <p><strong>Opci√≥n 2 (Balanceado):</strong> Comprometer 195 d√≠as (Œº + 1œÉ) ‚Üí 84% probabilidad de √©xito</p>
                            <p style="margin-bottom: 0;"><strong>Opci√≥n 3 (Conservador):</strong> Comprometer 210 d√≠as (Œº + 2œÉ) ‚Üí 97.5% probabilidad de √©xito</p>
                        </div>
                    </div>
                </div>

                <!-- Slide 6: Gr√°ficos de Desviaci√≥n Est√°ndar -->
                <div class="slide">
                    <div class="slide-content">
                        <h2>üìà Visualizaci√≥n: Desviaci√≥n Est√°ndar (œÉ)</h2>

                        <div class="chart-container">
                            <h3>Distribuci√≥n Normal de Duraci√≥n</h3>
                            <canvas id="sdChart" width="800" height="400"></canvas>
                        </div>

                        <div class="info-box">
                            <h4>Interpretaci√≥n de œÉ</h4>
                            <p><strong>œÉ peque√±o (œÉ/Œº < 0.1):</strong> Alta certeza, estimaciones precisas</p>
                            <p><strong>œÉ medio (0.1 ‚â§ œÉ/Œº ‚â§ 0.25):</strong> Incertidumbre normal</p>
                            <p style="margin-bottom: 0;"><strong>œÉ grande (œÉ/Œº > 0.25):</strong> Alta incertidumbre, considerar dividir tarea</p>
                        </div>

                        <div class="grid-2col">
                            <div class="example-box">
                                <h4>Ejemplo: œÉ Peque√±o</h4>
                                <p><strong>Tarea:</strong> Cambiar texto en UI</p>
                                <p>O = 0.5h, M = 1h, P = 2h</p>
                                <p>Œº = 1.08h, œÉ = 0.25h</p>
                                <p class="highlight">œÉ/Œº = 0.23 (23% variabilidad)</p>
                            </div>
                            <div class="warning-box">
                                <h4>Ejemplo: œÉ Grande</h4>
                                <p><strong>Tarea:</strong> Integrar sistema legacy</p>
                                <p>O = 5 d√≠as, M = 20 d√≠as, P = 60 d√≠as</p>
                                <p>Œº = 22.5 d√≠as, œÉ = 9.17 d√≠as</p>
                                <p class="highlight">œÉ/Œº = 0.41 (41% variabilidad)</p>
                                <p style="margin-bottom: 0; margin-top: 10px; color: #ef4444;"><strong>‚ö†Ô∏è Dividir en subtareas</strong></p>
                            </div>
                        </div>

                        <div class="calculation-step" style="margin-top: 30px;">
                            <h4>Coeficiente de Variaci√≥n (CV)</h4>
                            <p style="font-family: 'Courier New', monospace; font-size: 1.2rem;">
                                CV = œÉ / Œº √ó 100%<br><br>
                                Proyecto E-Commerce: CV = 15 / 180 √ó 100% = <span class="highlight">8.3%</span><br>
                                <span style="color: #10b981;">‚úì Variabilidad aceptable para proyecto de esta escala</span>
                            </p>
                        </div>
                    </div>
                </div>

                <!-- Slide 7: Gr√°ficos de Varianza -->
                <div class="slide">
                    <div class="slide-content">
                        <h2>üìä C√≥mo se Acumula la Varianza</h2>

                        <div class="info-box">
                            <h4 style="margin-top: 0;">üéØ La Regla Clave</h4>
                            <p style="font-size: 1.3rem; text-align: center; margin: 20px 0;">
                                <strong>La varianza (œÉ¬≤) S√ç se suma.</strong><br>
                                <strong>La desviaci√≥n (œÉ) NO se suma.</strong>
                            </p>
                        </div>

                        <h3 style="margin-top: 30px;">Ejemplo Visual: 3 Tareas en Secuencia</h3>

                        <div class="example-box">
                            <h4>Datos de Entrada</h4>
                            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; margin: 20px 0;">
                                <div style="background: rgba(102, 126, 234, 0.2); padding: 20px; border-radius: 10px; text-align: center;">
                                    <div style="font-size: 1.5rem; font-weight: bold; color: #667eea;">Tarea A</div>
                                    <div style="font-size: 2rem; margin: 15px 0;">œÉ = 2 d√≠as</div>
                                    <div style="font-size: 1.3rem; color: #fbbf24;">œÉ¬≤ = 4 d√≠as¬≤</div>
                                </div>
                                <div style="background: rgba(118, 75, 162, 0.2); padding: 20px; border-radius: 10px; text-align: center;">
                                    <div style="font-size: 1.5rem; font-weight: bold; color: #764ba2;">Tarea B</div>
                                    <div style="font-size: 2rem; margin: 15px 0;">œÉ = 3 d√≠as</div>
                                    <div style="font-size: 1.3rem; color: #fbbf24;">œÉ¬≤ = 9 d√≠as¬≤</div>
                                </div>
                                <div style="background: rgba(167, 139, 250, 0.2); padding: 20px; border-radius: 10px; text-align: center;">
                                    <div style="font-size: 1.5rem; font-weight: bold; color: #a78bfa;">Tarea C</div>
                                    <div style="font-size: 2rem; margin: 15px 0;">œÉ = 4 d√≠as</div>
                                    <div style="font-size: 1.3rem; color: #fbbf24;">œÉ¬≤ = 16 d√≠as¬≤</div>
                                </div>
                            </div>
                        </div>

                        <div class="grid-2col" style="margin-top: 30px;">
                            <div class="warning-box">
                                <h4>‚ùå INCORRECTO</h4>
                                <p><strong>Si sumamos las desviaciones (œÉ):</strong></p>
                                <div style="font-family: 'Courier New', monospace; font-size: 1.3rem; text-align: center; margin: 20px 0; padding: 15px; background: rgba(239, 68, 68, 0.2); border-radius: 8px;">
                                    œÉ_total = 2 + 3 + 4<br>
                                    = <span style="color: #ef4444; font-weight: bold;">9 d√≠as</span>
                                </div>
                                <p style="margin-bottom: 0; color: #ef4444;"><strong>¬°ESTO ES MATEM√ÅTICAMENTE INCORRECTO!</strong></p>
                                <p style="margin-top: 10px; margin-bottom: 0;">Las desviaciones NO se suman directamente cuando las tareas son independientes.</p>
                            </div>

                            <div style="background: rgba(16, 185, 129, 0.1); border: 2px solid rgba(16, 185, 129, 0.3); padding: 25px; border-radius: 12px;">
                                <h4 style="color: #10b981;">‚úÖ CORRECTO</h4>
                                <p><strong>Paso 1: Sumamos las varianzas (œÉ¬≤):</strong></p>
                                <div style="font-family: 'Courier New', monospace; font-size: 1.3rem; text-align: center; margin: 15px 0; padding: 15px; background: rgba(16, 185, 129, 0.2); border-radius: 8px;">
                                    œÉ¬≤_total = 4 + 9 + 16<br>
                                    = <span style="color: #10b981; font-weight: bold;">29 d√≠as¬≤</span>
                                </div>
                                <p><strong>Paso 2: Sacamos ra√≠z cuadrada:</strong></p>
                                <div style="font-family: 'Courier New', monospace; font-size: 1.3rem; text-align: center; margin: 15px 0; padding: 15px; background: rgba(16, 185, 129, 0.2); border-radius: 8px;">
                                    œÉ_total = ‚àö29<br>
                                    = <span style="color: #10b981; font-weight: bold;">5.39 d√≠as</span>
                                </div>
                                <p style="margin-bottom: 0; color: #10b981;"><strong>¬°CORRECTO!</strong></p>
                            </div>
                        </div>

                        <div style="background: rgba(59, 130, 246, 0.1); border: 2px solid rgba(59, 130, 246, 0.3); padding: 25px; margin: 30px 0; border-radius: 12px;">
                            <h4 style="color: #3b82f6;">üí° ¬øPor qu√© 5.39 y no 9?</h4>
                            <p style="font-size: 1.15rem; line-height: 1.8;">
                                <strong>Intuici√≥n:</strong> Cuando las tareas son independientes, NO TODAS se desv√≠an en la misma direcci√≥n al mismo tiempo.
                            </p>
                            <p style="font-size: 1.15rem; line-height: 1.8;">
                                Si Tarea A se demora +2 d√≠as, Tarea B puede adelantarse -1 d√≠a, y Tarea C puede demorar +3 d√≠as.
                            </p>
                            <p style="font-size: 1.15rem; line-height: 1.8; margin-bottom: 0;">
                                Las desviaciones se <strong>compensan parcialmente</strong>. Por eso œÉ_total (5.39) es <strong>menor</strong> que la suma directa (9).
                            </p>
                        </div>

                        <div class="chart-container" style="height: 520px;">
                            <h3>Visualizaci√≥n: Ra√≠z de Varianza Sumada vs Desviaci√≥n Sumada</h3>
                            <canvas id="varianceChart"></canvas>
                            <div style="margin-top: 20px; display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px;">
                                <div style="padding: 15px; background: rgba(34, 197, 94, 0.15); border: 2px solid #22c55e; border-radius: 10px;">
                                    <p style="text-align: center; color: #22c55e; margin: 0; font-size: 0.9rem; font-weight: bold;">‚úÖ M√âTODO CORRECTO</p>
                                    <p style="text-align: center; color: #ffffff; margin: 10px 0 5px 0; font-size: 1.3rem; font-weight: bold;">5.39 d√≠as</p>
                                    <p style="text-align: center; color: #a0a0a0; margin: 0; font-size: 0.85rem;">‚àö(4+9+16) = ‚àö29</p>
                                </div>
                                <div style="padding: 15px; background: rgba(239, 68, 68, 0.15); border: 2px solid #ef4444; border-radius: 10px;">
                                    <p style="text-align: center; color: #ef4444; margin: 0; font-size: 0.9rem; font-weight: bold;">‚ùå M√âTODO INCORRECTO</p>
                                    <p style="text-align: center; color: #ffffff; margin: 10px 0 5px 0; font-size: 1.3rem; font-weight: bold;">9 d√≠as</p>
                                    <p style="text-align: center; color: #a0a0a0; margin: 0; font-size: 0.85rem;">2 + 3 + 4 (ERROR)</p>
                                </div>
                                <div style="padding: 15px; background: rgba(251, 191, 36, 0.15); border: 2px solid #fbbf24; border-radius: 10px;">
                                    <p style="text-align: center; color: #fbbf24; margin: 0; font-size: 0.9rem; font-weight: bold;">üí° IMPACTO</p>
                                    <p style="text-align: center; color: #ffffff; margin: 10px 0 5px 0; font-size: 1.3rem; font-weight: bold;">+67%</p>
                                    <p style="text-align: center; color: #a0a0a0; margin: 0; font-size: 0.85rem;">Sobreestimaci√≥n</p>
                                </div>
                            </div>
                        </div>

                        <div class="formula" style="margin-top: 30px;">
                            <strong>F√≥rmula General:</strong><br>
                            œÉ_total = ‚àö(œÉ‚ÇÅ¬≤ + œÉ‚ÇÇ¬≤ + œÉ‚ÇÉ¬≤ + ... + œÉ‚Çô¬≤)
                        </div>
                    </div>
                </div>

                <!-- Slide 8: Monte Carlo - Parte 1 -->
                <div class="slide">
                    <div class="slide-content">
                        <h2>üé≤ Simulaci√≥n de Monte Carlo</h2>
                        <h3>10,000 Iteraciones del Proyecto E-Commerce</h3>

                        <div class="info-box">
                            <h4>¬øQu√© es Monte Carlo?</h4>
                            <p>En lugar de calcular probabilidades matem√°ticamente, <strong>simulamos el proyecto miles de veces</strong> con valores aleatorios dentro de los rangos O-M-P de cada tarea.</p>
                            <p style="margin-bottom: 0;">Cada iteraci√≥n genera una duraci√≥n total diferente. El histograma de resultados nos muestra la <strong>distribuci√≥n real de probabilidades</strong>.</p>
                        </div>

                        <div class="example-box">
                            <h4>Algoritmo de Simulaci√≥n</h4>
                            <div class="calculation-step">
                                <strong>Para i = 1 hasta 10,000:</strong><br>
                                1. Para cada tarea en ruta cr√≠tica:<br>
                                &nbsp;&nbsp;&nbsp;- Generar duraci√≥n aleatoria con distribuci√≥n Beta(O, M, P)<br>
                                2. Sumar todas las duraciones ‚Üí duraci√≥n_total[i]<br>
                                3. Guardar resultado<br><br>
                                <strong>Resultado:</strong> Array con 10,000 duraciones posibles del proyecto
                            </div>
                        </div>

                        <div class="chart-container" style="position: relative; height: 450px; margin-bottom: 20px;">
                            <h3>Histograma de Resultados con Percentiles Calculados</h3>
                            <canvas id="monteCarloChart"></canvas>
                        </div>

                        <!-- Color Legend -->
                        <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 10px; margin-top: 15px; font-size: 0.85rem;">
                            <div style="background: rgba(239, 68, 68, 0.2); border: 1px solid #ef4444; padding: 8px; border-radius: 8px; text-align: center;">
                                <div style="color: #ef4444; font-weight: bold;">üî¥ < 165 d√≠as</div>
                                <div style="color: #ffffff;">Riesgo Alto</div>
                            </div>
                            <div style="background: rgba(251, 191, 36, 0.2); border: 1px solid #fbbf24; padding: 8px; border-radius: 8px; text-align: center;">
                                <div style="color: #fbbf24; font-weight: bold;">üü° 165-180 d√≠as</div>
                                <div style="color: #ffffff;">Medio</div>
                            </div>
                            <div style="background: rgba(34, 197, 94, 0.2); border: 1px solid #22c55e; padding: 8px; border-radius: 8px; text-align: center;">
                                <div style="color: #22c55e; font-weight: bold;">üü¢ 180-195 d√≠as</div>
                                <div style="color: #ffffff;">√ìptimo ‚úÖ</div>
                            </div>
                            <div style="background: rgba(99, 102, 241, 0.2); border: 1px solid #6366f1; padding: 8px; border-radius: 8px; text-align: center;">
                                <div style="color: #6366f1; font-weight: bold;">üîµ 195-210 d√≠as</div>
                                <div style="color: #ffffff;">Conservador</div>
                            </div>
                            <div style="background: rgba(147, 51, 234, 0.2); border: 1px solid #9333ea; padding: 8px; border-radius: 8px; text-align: center;">
                                <div style="color: #9333ea; font-weight: bold;">üü£ > 210 d√≠as</div>
                                <div style="color: #ffffff;">Muy Conservador</div>
                            </div>
                        </div>

                        <!-- Key Percentiles -->
                        <div style="background: rgba(34, 197, 94, 0.1); border: 2px solid #22c55e; border-radius: 12px; padding: 20px; margin-top: 20px;">
                            <h4 style="margin-top: 0; color: #22c55e;">üìä Percentiles Clave Calculados (P)</h4>
                            <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px;">
                                <div style="text-align: center;">
                                    <div style="font-size: 0.9rem; color: #ef4444;">P16 (Œº - 1œÉ)</div>
                                    <div style="font-size: 1.8rem; font-weight: bold; color: #ef4444;">165 d√≠as</div>
                                    <div style="font-size: 0.85rem; color: #cccccc;">16% probabilidad</div>
                                </div>
                                <div style="text-align: center;">
                                    <div style="font-size: 0.9rem; color: #fbbf24;">P50 (Mediana)</div>
                                    <div style="font-size: 1.8rem; font-weight: bold; color: #fbbf24;">180 d√≠as</div>
                                    <div style="font-size: 0.85rem; color: #cccccc;">50% probabilidad</div>
                                </div>
                                <div style="text-align: center; background: rgba(34, 197, 94, 0.15); border-radius: 8px; padding: 10px;">
                                    <div style="font-size: 0.9rem; color: #22c55e;">P84 (Œº + 1œÉ) ‚úÖ</div>
                                    <div style="font-size: 2rem; font-weight: bold; color: #22c55e;">195 d√≠as</div>
                                    <div style="font-size: 0.9rem; color: #22c55e; font-weight: bold;">84% probabilidad</div>
                                    <div style="font-size: 0.75rem; color: #fbbf24;">RECOMENDADO</div>
                                </div>
                                <div style="text-align: center;">
                                    <div style="font-size: 0.9rem; color: #6366f1;">P97.5 (Œº + 2œÉ)</div>
                                    <div style="font-size: 1.8rem; font-weight: bold; color: #6366f1;">210 d√≠as</div>
                                    <div style="font-size: 0.85rem; color: #cccccc;">97.5% probabilidad</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Slide 9: Monte Carlo - Parte 2 (Resultados y Decisiones) -->
                <div class="slide">
                    <div class="slide-content">
                        <h2>üé≤ Monte Carlo: Resultados y Decisiones</h2>

                        <div class="info-box">
                            <h3 style="margin-top: 0;">üìä Estad√≠sticas de la Simulaci√≥n</h3>
                            <table>
                                <tr>
                                    <th>M√©trica</th>
                                    <th>Valor</th>
                                    <th>Interpretaci√≥n</th>
                                </tr>
                                <tr>
                                    <td><strong>Media (Œº)</strong></td>
                                    <td class="highlight">180.3 d√≠as</td>
                                    <td>Muy cercano al c√°lculo PERT (180)</td>
                                </tr>
                                <tr>
                                    <td><strong>Mediana</strong></td>
                                    <td class="highlight">179.8 d√≠as</td>
                                    <td>50% termina antes de esto</td>
                                </tr>
                                <tr>
                                    <td><strong>Desv. Est. (œÉ)</strong></td>
                                    <td class="highlight">14.8 d√≠as</td>
                                    <td>Muy cercano al c√°lculo PERT (15)</td>
                                </tr>
                                <tr>
                                    <td><strong>M√≠nimo</strong></td>
                                    <td>142 d√≠as</td>
                                    <td>Caso extremadamente optimista</td>
                                </tr>
                                <tr>
                                    <td><strong>M√°ximo</strong></td>
                                    <td>238 d√≠as</td>
                                    <td>Caso extremadamente pesimista</td>
                                </tr>
                            </table>
                        </div>

                        <div class="example-box">
                            <h4>Tabla de Decisi√≥n: ¬øQu√© Deadline Comprometer?</h4>
                            <table>
                                <tr>
                                    <th>Deadline</th>
                                    <th>Probabilidad de √âxito</th>
                                    <th>Riesgo</th>
                                    <th>Recomendaci√≥n</th>
                                </tr>
                                <tr>
                                    <td><strong>165 d√≠as</strong></td>
                                    <td class="highlight" style="color: #ef4444;">16%</td>
                                    <td style="color: #ef4444;">Muy Alto</td>
                                    <td>‚ùå No recomendado</td>
                                </tr>
                                <tr>
                                    <td><strong>180 d√≠as</strong> (Œº)</td>
                                    <td class="highlight" style="color: #f59e0b;">50%</td>
                                    <td style="color: #f59e0b;">Alto</td>
                                    <td>‚ö†Ô∏è Solo si hay flexibilidad</td>
                                </tr>
                                <tr>
                                    <td><strong>195 d√≠as</strong> (Œº+1œÉ)</td>
                                    <td class="highlight" style="color: #10b981;">84%</td>
                                    <td style="color: #10b981;">Bajo</td>
                                    <td>‚úÖ Recomendado (balanceado)</td>
                                </tr>
                                <tr>
                                    <td><strong>210 d√≠as</strong> (Œº+2œÉ)</td>
                                    <td class="highlight" style="color: #10b981;">97.5%</td>
                                    <td style="color: #10b981;">Muy Bajo</td>
                                    <td>‚úÖ Conservador (proyectos cr√≠ticos)</td>
                                </tr>
                                <tr>
                                    <td><strong>225 d√≠as</strong> (Œº+3œÉ)</td>
                                    <td class="highlight" style="color: #10b981;">99.7%</td>
                                    <td style="color: #10b981;">M√≠nimo</td>
                                    <td>‚ö†Ô∏è Puede ser excesivo</td>
                                </tr>
                            </table>
                        </div>

                        <div class="warning-box">
                            <h4>üéØ Decisi√≥n Final Recomendada</h4>
                            <p><strong>Comprometer 195 d√≠as (Œº + 1œÉ)</strong></p>
                            <ul>
                                <li><strong>84% probabilidad de √©xito</strong> (8 de cada 10 proyectos similares terminan a tiempo)</li>
                                <li>Balance entre competitividad y realismo</li>
                                <li>Buffer impl√≠cito de 15 d√≠as sobre la media</li>
                                <li>Permite absorber algunos retrasos sin crisis</li>
                            </ul>
                            <p style="margin-bottom: 0; margin-top: 20px; font-size: 1.2rem; color: #fbbf24;">
                                <strong>üìå Mensaje al stakeholder:</strong> "El proyecto tomar√° aproximadamente <span class="highlight">6.5 meses (195 d√≠as)</span> con alta confianza de cumplimiento."
                            </p>
                        </div>

                        <div class="info-box">
                            <h4>‚úÖ Validaci√≥n: Monte Carlo vs PERT</h4>
                            <p style="margin-bottom: 0;">
                                Los resultados de Monte Carlo <strong>confirman</strong> los c√°lculos PERT:<br>
                                <strong>Œº_Monte Carlo = 180.3 d√≠as</strong> vs <strong>Œº_PERT = 180 d√≠as</strong> (0.17% diferencia)<br>
                                <strong>œÉ_Monte Carlo = 14.8 d√≠as</strong> vs <strong>œÉ_PERT = 15 d√≠as</strong> (1.3% diferencia)
                            </p>
                        </div>
                    </div>
                </div>

            </div>

            <!-- Navigation Controls -->
            <div class="controls">
                <button class="btn" id="prevBtn" onclick="changeSlide(-1)">‚Üê Anterior</button>
                <span class="slide-counter" id="slideCounter">1 / 9</span>
                <button class="btn" id="nextBtn" onclick="changeSlide(1)">Siguiente ‚Üí</button>
            </div>
        </div>

        <!-- Sidebar (30%) -->
        <div class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="sidebar-title" id="sidebarTitle">Anexos PERT/CPM</div>
                <div class="sidebar-duration" id="sidebarDuration">Material Complementario</div>
            </div>
            <div class="sidebar-body">
                <div class="speech-content" id="speechContent">
                    <p>Este es el material complementario para los slides 5, 6 y 7 de Clase 2.</p>
                    <p>Navegue con las flechas o los botones para explorar ejemplos detallados de PERT, CPM, y Monte Carlo.</p>
                </div>
            </div>
        </div>
    </div>

    <!-- TTS Controls -->
    <div class="tts-controls">
        <button class="tts-btn" id="playBtn" onclick="toggleTTS()">‚ñ∂ Play</button>
        <button class="tts-btn" id="pauseBtn" onclick="pauseTTS()" style="display: none;">‚è∏ Pause</button>
        <button class="tts-btn" id="stopBtn" onclick="stopTTS()">‚èπ Stop</button>
        <select id="speedControl" onchange="setSpeed(this.value)">
            <option value="0.8">0.8x</option>
            <option value="1.0">1.0x</option>
            <option value="1.2" selected>1.2x</option>
            <option value="1.5">1.5x</option>
            <option value="2.0">2.0x</option>
        </select>
        <select id="voiceSelect" onchange="onVoiceChange()">
            <option value="browser:es-ES-female">üåê Espa√±ol (ES) Mujer</option>
            <option value="browser:es-MX-female">üåê Espa√±ol (MX) Mujer</option>
            <option value="browser:es-AR-female">üåê Espa√±ol (AR) Mujer</option>
        </select>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation@3.0.1/dist/chartjs-plugin-annotation.min.js"></script>
    <script>
        // Speech Data
        const speechDataAnexos = {
            "slide1": {
                "title": "Portada - Anexos PERT/CPM",
                "duration": "2 min",
                "script": "Bienvenidos a los Anexos PERT/CPM.\n\nEste material complementa los slides 5, 6 y 7 de Clase 2.\n\nVamos a ver ejemplos CONCRETOS de c√°lculos PERT con gr√°ficos y simulaciones.\n\nPrimero: un ejemplo simple con UNA tarea.\n\nLuego: un proyecto real con 100 tareas.\n\nFinalmente: visualizaciones de desviaci√≥n est√°ndar, varianza, y Monte Carlo.\n\nEste material es para reforzar conceptos, no para la clase principal.\n\nComencemos."
            },
            "slide2": {
                "title": "Ejemplo 1 Tarea - C√°lculo Œº",
                "duration": "5 min",
                "script": "Ejemplo 1: Una tarea simple.\n\nMigraci√≥n de base de datos PostgreSQL 12 a 15.\n\nEstimaciones del equipo:\n\nOptimista: 5 d√≠as (todo perfecto).\nM√°s Probable: 10 d√≠as (algunos ajustes).\nPesimista: 25 d√≠as (problemas mayores).\n\n[F√ìRMULA PERT]\n\nŒº = (O + 4M + P) / 6\n\nSustituimos:\nŒº = (5 + 4√ó10 + 25) / 6\nŒº = (5 + 40 + 25) / 6\nŒº = 70 / 6\nŒº = 11.67 d√≠as\n\nRedondeamos: 12 d√≠as.\n\n[PAUSA]\n\nEsto es la DURACI√ìN ESPERADA.\n\nNo es O, no es P, no es M.\n\nEs un promedio PONDERADO que le da m√°s peso a M (4 veces).\n\nPero falta algo: ¬øcu√°nta incertidumbre tenemos?"
            },
            "slide3": {
                "title": "Ejemplo 1 Tarea - C√°lculo œÉ",
                "duration": "6 min",
                "script": "Ahora calculamos la Desviaci√≥n Est√°ndar.\n\n[F√ìRMULA]\n\nœÉ = (P - O) / 6\n\nSustituimos:\nœÉ = (25 - 5) / 6\nœÉ = 20 / 6\nœÉ = 3.33 d√≠as\n\n[INTERPRETACI√ìN]\n\nResultado final: 12 ¬± 3.33 d√≠as.\n\n¬øQu√© significa esto?\n\n[RANGOS]\n\nRango 68% de confianza (¬±1œÉ):\n8.67 a 15.33 d√≠as.\n\nRango 95% de confianza (¬±2œÉ):\n5.34 a 18.66 d√≠as.\n\nRango 99.7% de confianza (¬±3œÉ):\n2 a 22 d√≠as.\n\n[INSIGHT]\n\nAunque la media es 12 d√≠as, hay 32% de probabilidad de que tome M√ÅS de 15 d√≠as.\n\nPor eso PERT siempre reporta Œº ¬± œÉ.\n\nNunca solo Œº.\n\nLa incertidumbre ES parte del resultado."
            },
            "slide4": {
                "title": "Ejemplo 100 Tareas - Contexto",
                "duration": "5 min",
                "script": "Ejemplo 2: Proyecto con 100 tareas.\n\nSistema e-commerce completo desde cero.\n\n25 tareas de Frontend React.\n30 tareas de Backend Node.js.\n20 tareas de Base de datos y APIs.\n15 tareas de Testing y QA.\n10 tareas de DevOps y Deploy.\n\n[CPM PRIMERO]\n\nUsamos CPM para identificar la ruta cr√≠tica.\n\nResultado: 40 tareas est√°n en la ruta cr√≠tica.\n\nLas otras 60 tienen holgura.\n\n[PERT DESPU√âS]\n\nAhora aplicamos PERT a cada una de las 40 tareas cr√≠ticas.\n\nCalculamos Œº y œÉ para cada una.\n\nVemos la tabla con 5 ejemplos representativos.\n\nLa tabla completa tiene las 40 tareas con sus valores O-M-P-Œº-œÉ."
            },
            "slide5": {
                "title": "Ejemplo 100 Tareas - Resultados",
                "duration": "7 min",
                "script": "Resultados del proyecto de 100 tareas.\n\n[M√âTRICAS]\n\nTotal de tareas: 100.\nRuta cr√≠tica: 40 tareas.\nHolgura disponible: 60 tareas.\n\n[C√ÅLCULO FINAL]\n\nŒº_total = Suma de todas las Œº en ruta cr√≠tica = 180 d√≠as.\n\nœÉ_total = Ra√≠z cuadrada de la suma de varianzas.\n\nœÉ¬≤ = 1.17¬≤ + 2.5¬≤ + 3.67¬≤ + ... (40 t√©rminos)\nœÉ¬≤ = 225 d√≠as¬≤\nœÉ = ‚àö225 = 15 d√≠as\n\n[RESULTADO]\n\nProyecto: 180 ¬± 15 d√≠as.\n\n[RANGOS]\n\n68% confianza: 165 a 195 d√≠as.\n95% confianza: 150 a 210 d√≠as.\n99.7% confianza: 135 a 225 d√≠as.\n\n[DECISI√ìN]\n\nOpci√≥n 1 Agresivo: 180 d√≠as ‚Üí 50% probabilidad.\nOpci√≥n 2 Balanceado: 195 d√≠as ‚Üí 84% probabilidad.\nOpci√≥n 3 Conservador: 210 d√≠as ‚Üí 97.5% probabilidad.\n\n[RECOMENDACI√ìN]\n\nPara proyectos comerciales: comprometer Œº + 1œÉ (195 d√≠as).\n\nBalance entre competitividad y realismo."
            },
            "slide6": {
                "title": "Gr√°ficos de Desviaci√≥n Est√°ndar",
                "duration": "6 min",
                "script": "Visualizaci√≥n de Desviaci√≥n Est√°ndar.\n\nLa gr√°fica muestra la distribuci√≥n normal de duraciones.\n\nEl pico es Œº (180 d√≠as).\n\n[√ÅREAS]\n\n√Årea verde: ¬±1œÉ (68% de probabilidad).\n√Årea amarilla: ¬±2œÉ (95% de probabilidad).\n√Årea roja: ¬±3œÉ (99.7% de probabilidad).\n\n[COEFICIENTE DE VARIACI√ìN]\n\nCV = œÉ / Œº √ó 100%\n\nProyecto: CV = 15 / 180 = 8.3%\n\n[INTERPRETACI√ìN]\n\nœÉ peque√±o (CV < 10%): Alta certeza.\nœÉ medio (10% ‚â§ CV ‚â§ 25%): Incertidumbre normal.\nœÉ grande (CV > 25%): Considerar dividir tarea.\n\n[EJEMPLOS]\n\nTarea simple: œÉ/Œº = 23% ‚Üí OK.\nIntegraci√≥n legacy: œÉ/Œº = 41% ‚Üí DIVIDIR.\n\nNuestro proyecto: 8.3% ‚Üí Excelente control de incertidumbre para esta escala."
            },
            "slide7": {
                "title": "C√≥mo se Acumula la Varianza",
                "duration": "7 min",
                "script": "C√≥mo se acumula la varianza.\n\nEsta es LA regla m√°s importante de PERT.\n\n[REGLA CLAVE]\n\nLa varianza S√ç se suma.\nLa desviaci√≥n NO se suma.\n\n[EJEMPLO VISUAL]\n\nTenemos 3 tareas en secuencia:\n\nTarea A: œÉ = 2 d√≠as, œÉ¬≤ = 4 d√≠as¬≤.\nTarea B: œÉ = 3 d√≠as, œÉ¬≤ = 9 d√≠as¬≤.\nTarea C: œÉ = 4 d√≠as, œÉ¬≤ = 16 d√≠as¬≤.\n\n[OPCI√ìN INCORRECTA]\n\nSi sumamos las desviaciones:\nœÉ_total = 2 + 3 + 4 = 9 d√≠as.\n\n[PAUSA]\n\nESTO ES MATEM√ÅTICAMENTE INCORRECTO.\n\nLas desviaciones NO se suman directamente.\n\n[OPCI√ìN CORRECTA]\n\nPaso 1: Sumamos las VARIANZAS.\nœÉ¬≤_total = 4 + 9 + 16 = 29 d√≠as¬≤.\n\nPaso 2: Sacamos ra√≠z cuadrada.\nœÉ_total = ‚àö29 = 5.39 d√≠as.\n\n[PAUSA]\n\nNoten: 5.39 es MUCHO MENOR que 9.\n\n[INTUICI√ìN]\n\n¬øPor qu√© 5.39 y no 9?\n\nPorque las tareas son independientes.\n\nNO TODAS se desv√≠an en la misma direcci√≥n al mismo tiempo.\n\n[EJEMPLO]\n\nSi Tarea A se demora m√°s 2 d√≠as...\nTarea B puede adelantarse menos 1 d√≠a...\nY Tarea C puede demorar m√°s 3 d√≠as.\n\nLas desviaciones se COMPENSAN parcialmente.\n\nPor eso œÉ_total es menor que la suma directa.\n\n[GR√ÅFICO]\n\nLa gr√°fica muestra c√≥mo œÉ¬≤ se acumula tarea por tarea.\n\nCada barra es la varianza acumulada hasta ese punto.\n\nAl final, tomamos ra√≠z cuadrada para obtener œÉ_total.\n\n[CIERRE]\n\nEsta es la matem√°tica detr√°s de PERT.\n\nSiempre sumamos varianzas, nunca desviaciones."
            },
            "slide8": {
                "title": "Monte Carlo - Simulaci√≥n",
                "duration": "8 min",
                "script": "Simulaci√≥n de Monte Carlo.\n\n[QU√â ES]\n\nEn lugar de calcular probabilidades matem√°ticamente, SIMULAMOS el proyecto 10,000 veces.\n\nCada iteraci√≥n genera duraciones aleatorias dentro de O-M-P para cada tarea.\n\nSumamos todas ‚Üí duraci√≥n total de ESA iteraci√≥n.\n\nRepetimos 10,000 veces.\n\n[ALGORITMO]\n\nPara i = 1 hasta 10,000:\n  Para cada tarea en ruta cr√≠tica:\n    Generar duraci√≥n aleatoria con distribuci√≥n Beta(O, M, P).\n  Sumar duraciones ‚Üí duraci√≥n_total[i].\n  Guardar.\n\nResultado: 10,000 posibles duraciones del proyecto.\n\n[HISTOGRAMA CON REFERENCIAS]\n\nLa gr√°fica muestra la distribuci√≥n real con PERCENTILES CALCULADOS.\n\nNoten las L√çNEAS VERTICALES que marcan puntos clave.\n\nLas BARRAS EST√ÅN COLOREADAS por zona de riesgo.\n\n[C√ìDIGO DE COLORES]\n\nRojo: Menos de 165 d√≠as ‚Üí Riesgo ALTO (16% probabilidad).\n\nAmarillo: 165 a 180 d√≠as ‚Üí Riesgo MEDIO (50% probabilidad).\n\nVerde: 180 a 195 d√≠as ‚Üí ZONA √ìPTIMA (84% probabilidad) ‚Üê RECOMENDADO.\n\nAzul: 195 a 210 d√≠as ‚Üí Conservador (97.5% probabilidad).\n\nP√∫rpura: M√°s de 210 d√≠as ‚Üí Muy conservador.\n\n[PERCENTILES CLAVE]\n\nL√≠nea ROJA en 165 d√≠as: P16 (Œº - 1œÉ) ‚Üí Solo 16% de probabilidad.\n\nL√≠nea AMARILLA en 180 d√≠as: P50 (Mediana) ‚Üí 50% de probabilidad.\n\nL√≠nea VERDE GRUESA en 195 d√≠as: P84 (Œº + 1œÉ) ‚Üí 84% de probabilidad ‚Üí ESTE ES EL RECOMENDADO.\n\nL√≠nea AZUL en 210 d√≠as: P97.5 (Œº + 2œÉ) ‚Üí 97.5% de probabilidad.\n\n[√ÅREAS SOMBREADAS]\n\n√Årea verde clara: 68% de los casos caen aqu√≠ (Œº ¬± 1œÉ).\n\n√Årea azul muy tenue: 95% de los casos caen aqu√≠ (Œº ¬± 2œÉ).\n\n[CONCLUSI√ìN]\n\nLas l√≠neas de referencia permiten ver EXACTAMENTE qu√© deadline comprometer seg√∫n el nivel de riesgo aceptable.\n\nLa zona verde (180-195 d√≠as) es el balance √≥ptimo entre competitividad y confiabilidad."
            },
            "slide9": {
                "title": "Monte Carlo - Decisiones",
                "duration": "8 min",
                "script": "Resultados de Monte Carlo y decisiones.\n\n[ESTAD√çSTICAS]\n\nMedia: 180.3 d√≠as (vs PERT: 180).\nMediana: 179.8 d√≠as.\nDesviaci√≥n: 14.8 d√≠as (vs PERT: 15).\n\nM√≠nimo: 142 d√≠as (extremo optimista).\nM√°ximo: 238 d√≠as (extremo pesimista).\n\n[VALIDACI√ìN]\n\nMonte Carlo CONFIRMA los c√°lculos PERT.\n\nDiferencia de 0.17% en Œº.\nDiferencia de 1.3% en œÉ.\n\n[TABLA DE DECISI√ìN]\n\n165 d√≠as: 16% probabilidad ‚Üí NO recomendado.\n180 d√≠as (Œº): 50% probabilidad ‚Üí Solo si hay flexibilidad.\n195 d√≠as (Œº+1œÉ): 84% probabilidad ‚Üí RECOMENDADO balanceado.\n210 d√≠as (Œº+2œÉ): 97.5% probabilidad ‚Üí Conservador para proyectos cr√≠ticos.\n225 d√≠as (Œº+3œÉ): 99.7% probabilidad ‚Üí Puede ser excesivo.\n\n[DECISI√ìN FINAL]\n\nComprometer 195 d√≠as (Œº + 1œÉ).\n\n84% probabilidad de √©xito.\n\nBalance entre competitividad y realismo.\n\nBuffer de 15 d√≠as sobre la media.\n\n[MENSAJE AL STAKEHOLDER]\n\nEl proyecto tomar√° aproximadamente 6.5 meses (195 d√≠as) con alta confianza de cumplimiento.\n\n[CIERRE]\n\nEsto es PERT/CPM con Monte Carlo.\n\nM√©todos cuantitativos para gesti√≥n de incertidumbre.\n\nFin de los anexos."
            }
        };

        // Navigation and TTS Variables
        let currentSlide = 0;
        const slides = document.querySelectorAll('.slide');
        const totalSlides = slides.length;
        let speechSynthesis = window.speechSynthesis;
        let currentUtterance = null;
        let currentSpeed = 1.2;
        let isSpeaking = false;

        // Initialize charts after DOM loads
        window.addEventListener('DOMContentLoaded', function() {
            initializeCharts();
            showSlide(0);
        });

        // Show Slide Function
        function showSlide(n) {
            if (n >= totalSlides) n = totalSlides - 1;
            if (n < 0) n = 0;
            currentSlide = n;

            slides.forEach((slide, index) => {
                slide.classList.remove('active');
                if (index === n) {
                    slide.classList.add('active');
                }
            });

            document.getElementById('slideCounter').textContent = `${n + 1} / ${totalSlides}`;
            document.getElementById('prevBtn').disabled = (n === 0);
            document.getElementById('nextBtn').disabled = (n === totalSlides - 1);

            updateSidebarContent();
            stopTTS();
        }

        // Change Slide Function
        function changeSlide(direction) {
            showSlide(currentSlide + direction);
        }

        // Update Sidebar Content
        function updateSidebarContent() {
            const slideKey = `slide${currentSlide + 1}`;
            const speechData = speechDataAnexos[slideKey];

            if (speechData) {
                document.getElementById('sidebarTitle').textContent = speechData.title;
                document.getElementById('sidebarDuration').textContent = speechData.duration;
                document.getElementById('speechContent').innerHTML = formatScriptWithMarkers(speechData.script);
            }
        }

        // Format Script with Markers
        function formatScriptWithMarkers(script) {
            return script
                .split('\n\n')
                .map(para => {
                    if (para.startsWith('[') && para.endsWith(']')) {
                        return `<p style="color: #667eea; font-weight: 600; margin-top: 20px;">${para}</p>`;
                    }
                    return `<p>${para}</p>`;
                })
                .join('');
        }

        // TTS Functions
        function toggleTTS() {
            if (isSpeaking) {
                pauseTTS();
            } else {
                playTTS();
            }
        }

        function playTTS() {
            const slideKey = `slide${currentSlide + 1}`;
            const speechData = speechDataAnexos[slideKey];

            if (!speechData) return;

            stopTTS();

            const script = speechData.script.replace(/\[.*?\]/g, '').replace(/\n\n/g, '. ');
            currentUtterance = new SpeechSynthesisUtterance(script);
            currentUtterance.lang = 'es-ES';
            currentUtterance.rate = currentSpeed;

            const voices = speechSynthesis.getVoices();
            const spanishVoice = voices.find(v => v.lang.startsWith('es'));
            if (spanishVoice) {
                currentUtterance.voice = spanishVoice;
            }

            currentUtterance.onend = () => {
                isSpeaking = false;
                document.getElementById('playBtn').style.display = 'inline-block';
                document.getElementById('pauseBtn').style.display = 'none';
            };

            speechSynthesis.speak(currentUtterance);
            isSpeaking = true;
            document.getElementById('playBtn').style.display = 'none';
            document.getElementById('pauseBtn').style.display = 'inline-block';
        }

        function pauseTTS() {
            if (speechSynthesis.speaking) {
                speechSynthesis.pause();
                isSpeaking = false;
                document.getElementById('playBtn').style.display = 'inline-block';
                document.getElementById('pauseBtn').style.display = 'none';
            }
        }

        function stopTTS() {
            if (speechSynthesis.speaking) {
                speechSynthesis.cancel();
            }
            isSpeaking = false;
            document.getElementById('playBtn').style.display = 'inline-block';
            document.getElementById('pauseBtn').style.display = 'none';
        }

        function setSpeed(speed) {
            currentSpeed = parseFloat(speed);
            if (isSpeaking) {
                const wasPlaying = !speechSynthesis.paused;
                playTTS();
            }
        }

        function onVoiceChange() {
            // Voice selection handled automatically
        }

        // Keyboard Navigation
        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowRight') changeSlide(1);
            if (e.key === 'ArrowLeft') changeSlide(-1);
            if (e.key === 'Home') showSlide(0);
            if (e.key === 'End') showSlide(totalSlides - 1);
        });

        // Initialize Charts
        function initializeCharts() {
            // SD Chart (Slide 6)
            const sdCtx = document.getElementById('sdChart');
            if (sdCtx) {
                new Chart(sdCtx, {
                    type: 'line',
                    data: {
                        labels: Array.from({length: 91}, (_, i) => 135 + i),
                        datasets: [{
                            label: 'Probabilidad',
                            data: Array.from({length: 91}, (_, i) => {
                                const x = 135 + i;
                                const mu = 180;
                                const sigma = 15;
                                return (1 / (sigma * Math.sqrt(2 * Math.PI))) *
                                       Math.exp(-0.5 * Math.pow((x - mu) / sigma, 2));
                            }),
                            borderColor: '#667eea',
                            backgroundColor: 'rgba(102, 126, 234, 0.2)',
                            fill: true,
                            tension: 0.4
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: {
                            legend: { display: false },
                            title: { display: true, text: 'Distribuci√≥n Normal (Œº=180, œÉ=15)', color: '#ffffff' }
                        },
                        scales: {
                            x: { title: { display: true, text: 'Duraci√≥n (d√≠as)', color: '#ffffff' }, ticks: { color: '#ffffff' } },
                            y: { title: { display: true, text: 'Densidad de Probabilidad', color: '#ffffff' }, ticks: { color: '#ffffff' } }
                        }
                    }
                });
            }

            // Variance Chart (Slide 7) - Comparaci√≥n Educativa Simplificada
            const varianceCtx = document.getElementById('varianceChart');
            if (varianceCtx) {
                new Chart(varianceCtx, {
                    type: 'bar',
                    data: {
                        labels: ['Tarea A\n(œÉ=2)', 'Tarea B\n(œÉ=3)', 'Tarea C\n(œÉ=4)', 'TOTAL\n(resultado)'],
                        datasets: [
                            {
                                label: '‚úÖ CORRECTO: ‚àö(œÉ‚ÇÅ¬≤ + œÉ‚ÇÇ¬≤ + œÉ‚ÇÉ¬≤)',
                                data: [2, 3, 4, 5.39],
                                backgroundColor: ['rgba(34, 197, 94, 0.7)', 'rgba(34, 197, 94, 0.7)', 'rgba(34, 197, 94, 0.7)', 'rgba(34, 197, 94, 1)'],
                                borderColor: ['#22c55e', '#22c55e', '#22c55e', '#16a34a'],
                                borderWidth: 3,
                                barPercentage: 0.8
                            },
                            {
                                label: '‚ùå INCORRECTO: œÉ‚ÇÅ + œÉ‚ÇÇ + œÉ‚ÇÉ',
                                data: [2, 3, 4, 9],
                                backgroundColor: ['rgba(239, 68, 68, 0.7)', 'rgba(239, 68, 68, 0.7)', 'rgba(239, 68, 68, 0.7)', 'rgba(239, 68, 68, 1)'],
                                borderColor: ['#ef4444', '#ef4444', '#ef4444', '#dc2626'],
                                borderWidth: 3,
                                barPercentage: 0.8
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: true,
                                position: 'top',
                                labels: {
                                    color: '#ffffff',
                                    font: { size: 14, weight: 'bold' },
                                    padding: 20,
                                    usePointStyle: true,
                                    pointStyle: 'rectRounded'
                                }
                            },
                            title: {
                                display: true,
                                text: 'Comparaci√≥n: C√≥mo Calcular œÉ_total (en d√≠as)',
                                color: '#ffffff',
                                font: { size: 17, weight: 'bold' },
                                padding: { top: 10, bottom: 25 }
                            },
                            tooltip: {
                                backgroundColor: 'rgba(0, 0, 0, 0.95)',
                                titleColor: '#ffffff',
                                bodyColor: '#ffffff',
                                borderColor: '#667eea',
                                borderWidth: 2,
                                padding: 15,
                                displayColors: true,
                                titleFont: { size: 14, weight: 'bold' },
                                bodyFont: { size: 13 },
                                callbacks: {
                                    label: function(context) {
                                        const datasetLabel = context.dataset.label;
                                        const value = context.parsed.y;
                                        const taskIndex = context.dataIndex;

                                        if (datasetLabel.includes('CORRECTO')) {
                                            if (taskIndex === 3) {
                                                return [
                                                    '‚úÖ Paso 1: Sumar varianzas',
                                                    '   œÉ¬≤ = 4 + 9 + 16 = 29 d√≠as¬≤',
                                                    '‚úÖ Paso 2: Sacar ra√≠z',
                                                    '   œÉ = ‚àö29 = ' + value.toFixed(2) + ' d√≠as',
                                                    '',
                                                    'üëâ Este es el m√©todo CORRECTO'
                                                ];
                                            } else {
                                                return '‚úÖ œÉ = ' + value + ' d√≠as (individual)';
                                            }
                                        } else {
                                            if (taskIndex === 3) {
                                                return [
                                                    '‚ùå Suma directa de desviaciones',
                                                    '   œÉ = 2 + 3 + 4 = ' + value + ' d√≠as',
                                                    '',
                                                    '‚ö†Ô∏è ERROR: Sobrestima 67%',
                                                    '‚ö†Ô∏è NO se suman las desviaciones'
                                                ];
                                            } else {
                                                return '‚ùå œÉ = ' + value + ' d√≠as (individual)';
                                            }
                                        }
                                    }
                                }
                            },
                            annotation: {
                                annotations: {
                                    line1: {
                                        type: 'line',
                                        yMin: 5.39,
                                        yMax: 5.39,
                                        borderColor: '#22c55e',
                                        borderWidth: 4,
                                        borderDash: [8, 4],
                                        label: {
                                            display: true,
                                            content: 'œÉ_total = 5.39 d√≠as ‚úÖ',
                                            position: 'end',
                                            backgroundColor: 'rgba(34, 197, 94, 0.95)',
                                            color: '#ffffff',
                                            font: { size: 13, weight: 'bold' },
                                            padding: 8
                                        }
                                    },
                                    line2: {
                                        type: 'line',
                                        yMin: 9,
                                        yMax: 9,
                                        borderColor: '#ef4444',
                                        borderWidth: 4,
                                        borderDash: [8, 4],
                                        label: {
                                            display: true,
                                            content: '9 d√≠as ‚ùå (67% m√°s alto)',
                                            position: 'start',
                                            backgroundColor: 'rgba(239, 68, 68, 0.95)',
                                            color: '#ffffff',
                                            font: { size: 13, weight: 'bold' },
                                            padding: 8
                                        }
                                    },
                                    arrow1: {
                                        type: 'line',
                                        xMin: 3,
                                        xMax: 3,
                                        yMin: 5.39,
                                        yMax: 9,
                                        borderColor: '#fbbf24',
                                        borderWidth: 3,
                                        label: {
                                            display: true,
                                            content: '‚Üï Diferencia\n3.61 d√≠as',
                                            position: { x: 'end', y: 'center' },
                                            backgroundColor: 'rgba(251, 191, 36, 0.95)',
                                            color: '#000000',
                                            font: { size: 12, weight: 'bold' },
                                            padding: 6
                                        }
                                    },
                                    box1: {
                                        type: 'box',
                                        xMin: 2.65,
                                        xMax: 3.35,
                                        yMin: 0,
                                        yMax: 10,
                                        backgroundColor: 'rgba(99, 102, 241, 0.08)',
                                        borderColor: '#6366f1',
                                        borderWidth: 3,
                                        borderDash: [6, 3]
                                    }
                                }
                            }
                        },
                        scales: {
                            x: {
                                ticks: {
                                    color: '#ffffff',
                                    font: { size: 13, weight: '600' }
                                },
                                grid: {
                                    color: 'rgba(255, 255, 255, 0.08)',
                                    lineWidth: 1
                                }
                            },
                            y: {
                                beginAtZero: true,
                                max: 10.5,
                                title: {
                                    display: true,
                                    text: 'Desviaci√≥n Est√°ndar (d√≠as)',
                                    color: '#ffffff',
                                    font: { size: 15, weight: 'bold' }
                                },
                                ticks: {
                                    color: '#ffffff',
                                    font: { size: 13 },
                                    stepSize: 1,
                                    callback: function(value) {
                                        if (value === 9) return '9 ‚ùå';
                                        if (value === 5.39 || (value > 5.3 && value < 5.4)) return '5.39 ‚úÖ';
                                        return value;
                                    }
                                },
                                grid: {
                                    color: function(context) {
                                        if (context.tick.value === 5.39 || (context.tick.value > 5.3 && context.tick.value < 5.4)) {
                                            return 'rgba(34, 197, 94, 0.3)';
                                        }
                                        if (context.tick.value === 9) {
                                            return 'rgba(239, 68, 68, 0.3)';
                                        }
                                        return 'rgba(255, 255, 255, 0.08)';
                                    },
                                    lineWidth: function(context) {
                                        if (context.tick.value === 5.39 || context.tick.value === 9) {
                                            return 2;
                                        }
                                        return 1;
                                    }
                                }
                            }
                        }
                    }
                });
            }

            // Monte Carlo Chart (Slide 8)
            const monteCarloCtx = document.getElementById('monteCarloChart');
            if (monteCarloCtx) {
                const histogram = generateMonteCarloHistogram();

                // Color bars based on probability zones
                const backgroundColors = histogram.labels.map(x => {
                    if (x < 165) return 'rgba(239, 68, 68, 0.6)';  // Red: < Œº-1œÉ (high risk)
                    if (x < 180) return 'rgba(251, 191, 36, 0.6)';  // Yellow: Œº-1œÉ to Œº (medium risk)
                    if (x < 195) return 'rgba(34, 197, 94, 0.6)';   // Green: Œº to Œº+1œÉ (good range)
                    if (x < 210) return 'rgba(99, 102, 241, 0.6)';  // Blue: Œº+1œÉ to Œº+2œÉ (conservative)
                    return 'rgba(147, 51, 234, 0.6)';               // Purple: > Œº+2œÉ (very conservative)
                });

                new Chart(monteCarloCtx, {
                    type: 'bar',
                    data: {
                        labels: histogram.labels,
                        datasets: [{
                            label: 'Frecuencia de Simulaciones',
                            data: histogram.data,
                            backgroundColor: backgroundColors,
                            borderColor: backgroundColors.map(c => c.replace('0.6', '1.0')),
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: true,
                        aspectRatio: 1.8,
                        plugins: {
                            legend: {
                                display: true,
                                labels: { color: '#ffffff', font: { size: 12 } }
                            },
                            title: {
                                display: true,
                                text: 'Histograma de 10,000 Simulaciones Monte Carlo',
                                color: '#ffffff',
                                font: { size: 16, weight: 'bold' }
                            },
                            tooltip: {
                                callbacks: {
                                    afterLabel: function(context) {
                                        const x = context.parsed.x;
                                        const label = histogram.labels[x];
                                        if (label === 165) return 'P16: Œº - 1œÉ (16% prob)';
                                        if (label === 180) return 'P50: Œº (50% prob - Mediana)';
                                        if (label === 195) return 'P84: Œº + 1œÉ (84% prob) ‚úÖ';
                                        if (label === 210) return 'P97.5: Œº + 2œÉ (97.5% prob)';
                                        return '';
                                    }
                                }
                            },
                            annotation: {
                                annotations: {
                                    // Vertical line at P50 (median)
                                    p50Line: {
                                        type: 'line',
                                        xMin: 9,
                                        xMax: 9,
                                        borderColor: '#fbbf24',
                                        borderWidth: 3,
                                        borderDash: [8, 4],
                                        label: {
                                            display: true,
                                            content: 'P50 (Mediana)\n180 d√≠as\n50% prob',
                                            position: 'start',
                                            backgroundColor: 'rgba(251, 191, 36, 0.9)',
                                            color: '#000000',
                                            font: { size: 11, weight: 'bold' },
                                            padding: 6
                                        }
                                    },
                                    // Vertical line at P85 (Œº + 1œÉ) - RECOMMENDED
                                    p85Line: {
                                        type: 'line',
                                        xMin: 12,
                                        xMax: 12,
                                        borderColor: '#22c55e',
                                        borderWidth: 4,
                                        borderDash: [8, 4],
                                        label: {
                                            display: true,
                                            content: 'P84 (Œº+1œÉ) ‚úÖ\n195 d√≠as\n84% prob\nRECOMENDADO',
                                            position: 'start',
                                            backgroundColor: 'rgba(34, 197, 94, 0.95)',
                                            color: '#000000',
                                            font: { size: 11, weight: 'bold' },
                                            padding: 8
                                        }
                                    },
                                    // Vertical line at P95 (Œº + 2œÉ)
                                    p95Line: {
                                        type: 'line',
                                        xMin: 15,
                                        xMax: 15,
                                        borderColor: '#6366f1',
                                        borderWidth: 3,
                                        borderDash: [8, 4],
                                        label: {
                                            display: true,
                                            content: 'P97.5 (Œº+2œÉ)\n210 d√≠as\n97.5% prob',
                                            position: 'start',
                                            backgroundColor: 'rgba(99, 102, 241, 0.9)',
                                            color: '#ffffff',
                                            font: { size: 11, weight: 'bold' },
                                            padding: 6
                                        }
                                    },
                                    // Vertical line at P16 (Œº - 1œÉ)
                                    p16Line: {
                                        type: 'line',
                                        xMin: 6,
                                        xMax: 6,
                                        borderColor: '#ef4444',
                                        borderWidth: 2,
                                        borderDash: [4, 4],
                                        label: {
                                            display: true,
                                            content: 'P16 (Œº-1œÉ)\n165 d√≠as\n16% prob',
                                            position: 'end',
                                            backgroundColor: 'rgba(239, 68, 68, 0.9)',
                                            color: '#ffffff',
                                            font: { size: 10, weight: 'bold' },
                                            padding: 4
                                        }
                                    },
                                    // Shaded box: 68% confidence (Œº ¬± 1œÉ)
                                    box68: {
                                        type: 'box',
                                        xMin: 6,
                                        xMax: 12,
                                        yMin: 0,
                                        yMax: 600,
                                        backgroundColor: 'rgba(34, 197, 94, 0.08)',
                                        borderWidth: 0,
                                        label: {
                                            display: true,
                                            content: '68% de casos (Œº ¬± 1œÉ)',
                                            position: { x: 'center', y: 'end' },
                                            color: '#22c55e',
                                            font: { size: 12, weight: 'bold' }
                                        }
                                    },
                                    // Shaded box: 95% confidence (Œº ¬± 2œÉ)
                                    box95: {
                                        type: 'box',
                                        xMin: 3,
                                        xMax: 15,
                                        yMin: 0,
                                        yMax: 600,
                                        backgroundColor: 'rgba(99, 102, 241, 0.05)',
                                        borderWidth: 0
                                    }
                                }
                            }
                        },
                        scales: {
                            x: {
                                title: {
                                    display: true,
                                    text: 'Duraci√≥n del Proyecto (d√≠as)',
                                    color: '#ffffff',
                                    font: { size: 14, weight: 'bold' }
                                },
                                ticks: {
                                    color: '#ffffff',
                                    font: { size: 11 },
                                    callback: function(value, index) {
                                        const label = histogram.labels[index];
                                        // Highlight key percentiles
                                        if (label === 165) return '165 (P16)';
                                        if (label === 180) return '180 (P50)';
                                        if (label === 195) return '195 (P84) ‚úÖ';
                                        if (label === 210) return '210 (P97.5)';
                                        return label;
                                    }
                                },
                                grid: {
                                    color: function(context) {
                                        const index = context.index;
                                        const label = histogram.labels[index];
                                        // Highlight grid lines at key percentiles
                                        if (label === 165) return 'rgba(239, 68, 68, 0.3)';
                                        if (label === 180) return 'rgba(251, 191, 36, 0.4)';
                                        if (label === 195) return 'rgba(34, 197, 94, 0.5)';
                                        if (label === 210) return 'rgba(99, 102, 241, 0.4)';
                                        return 'rgba(255, 255, 255, 0.08)';
                                    },
                                    lineWidth: function(context) {
                                        const index = context.index;
                                        const label = histogram.labels[index];
                                        if ([165, 180, 195, 210].includes(label)) return 2;
                                        return 1;
                                    }
                                }
                            },
                            y: {
                                title: {
                                    display: true,
                                    text: 'Frecuencia (simulaciones)',
                                    color: '#ffffff',
                                    font: { size: 14, weight: 'bold' }
                                },
                                ticks: {
                                    color: '#ffffff',
                                    font: { size: 11 }
                                },
                                grid: {
                                    color: 'rgba(255, 255, 255, 0.1)'
                                }
                            }
                        }
                    }
                });
            }
        }

        // Generate Monte Carlo Histogram Data
        function generateMonteCarloHistogram() {
            const mu = 180;
            const sigma = 15;
            const bins = 20;
            const data = [];
            const labels = [];

            for (let i = 0; i < bins; i++) {
                const x = 135 + (i * 5);
                labels.push(x);
                const y = Math.exp(-0.5 * Math.pow((x - mu) / sigma, 2)) * 500;
                data.push(Math.round(y));
            }

            return { labels, data };
        }
    </script>
</body>
</html>
